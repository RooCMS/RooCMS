!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(r){"use strict";r.defineMode("smarty",function(e,t){var c,h=t.rightDelimiter||"}",b=t.leftDelimiter||"{",k=t.version||2,m=r.getMode(e,t.baseMode||"null"),f=["debug","extends","function","include","literal"],u={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/};function s(e,t){return c=t,e}function g(e,t){for(var r,i,n,a,o,l,f,u=e.string,s=e.pos;;){var d=u.indexOf(b,s);if(s=d+b.length,-1==d||(r=e,null==(i=d+b.length)&&(i=r.pos),3!==k||"{"!=b||i!=r.string.length&&!/\s/.test(r.string.charAt(i))))break}if(d==e.pos)return e.match(b),e.eat("*")?(n=e,l="comment",f="*"+h,o=function(e,t){for(;!e.eol();){if(e.match(f)){t.tokenize=g;break}e.next()}return l},((a=t).tokenize=o)(n,a)):(t.depth++,t.tokenize=v,c="startTag","tag");-1<d&&(e.string=u.slice(0,d));var p=m.token(e,t.base);return-1<d&&(e.string=u),p}function v(e,t){if(e.match(h,!0))return 3===k?(t.depth--,t.depth<=0&&(t.tokenize=g)):t.tokenize=g,s("tag",null);if(e.match(b,!0))return t.depth++,s("tag","startTag");var r=e.next();if("$"==r)return e.eatWhile(u.validIdentifier),s("variable-2","variable");if("|"==r)return s("operator","pipe");if("."==r)return s("operator","property");if(u.stringChar.test(r))return t.tokenize=(n=r,function(e,t){for(var r=null,i=null;!e.eol();){if(i=e.peek(),e.next()==n&&"\\"!==r){t.tokenize=v;break}r=i}return"string"}),s("string","string");if(u.operatorChars.test(r))return e.eatWhile(u.operatorChars),s("operator","operator");if("["==r||"]"==r)return s("bracket","bracket");if("("==r||")"==r)return s("bracket","operator");if(/\d/.test(r))return e.eatWhile(/\d/),s("number","number");if("variable"==t.last){if("@"==r)return e.eatWhile(u.validIdentifier),s("property","property");if("|"==r)return e.eatWhile(u.validIdentifier),s("qualifier","modifier")}else{if("pipe"==t.last)return e.eatWhile(u.validIdentifier),s("qualifier","modifier");if("whitespace"==t.last)return e.eatWhile(u.validIdentifier),s("attribute","modifier")}if("property"==t.last)return e.eatWhile(u.validIdentifier),s("property",null);if(/\s/.test(r))return c="whitespace",null;var n,i="";"/"!=r&&(i+=r);for(var a=null;a=e.eat(u.validIdentifier);)i+=a;for(var o=0,l=f.length;o<l;o++)if(f[o]==i)return s("keyword","keyword");return/\s/.test(r)?null:s("tag","tag")}return{startState:function(){return{base:r.startState(m),tokenize:g,last:null,depth:0}},copyState:function(e){return{base:r.copyState(m,e.base),tokenize:e.tokenize,last:e.last,depth:e.depth}},innerMode:function(e){if(e.tokenize==g)return{mode:m,state:e.base}},token:function(e,t){var r=t.tokenize(e,t);return t.last=c,r},indent:function(e,t){return e.tokenize==g&&m.indent?m.indent(e.base,t):r.Pass},blockCommentStart:b+"*",blockCommentEnd:"*"+h}}),r.defineMIME("text/x-smarty","smarty")});